x11 = 1;
x12 = 2;
x13 = 3;
x21 = 3;
x22 = 4;
x23 = 5;
y1 = [20.37 50.06 50.06 70.99 0 0 0 0]';
A1 = [x11^3 x11^2 x11 1 0 0 0 0;
    x12^3 x12^2 x12 1 0 0 0 0;
    0 0 0 0 x12^3 x12^2 x12 1;
    0 0 0 0 x13^3 x13^2 x13 1
    3*x12^2 2*x12 1 0 -3*x12^2 -2*x12 -1 0;
    6*x12 -2 0 0 -6*x12 -2 0 0;
    6*x11 2 0 0 0 0 0 0;
    0 0 0 0 6*x13 2 0 0];
x1 = inv(A1)*y1
%*******Step2 P3(x)+P4(x)*********
y2 = [70.99 100.98 100.98 130.85 0 0 0 0]';
A2 = [x21^3 x21^2 x21 1 0 0 0 0;
    x22^3 x22^2 x22 1 0 0 0 0;
    0 0 0 0 x22^3 x22^2 x22 1;
    0 0 0 0 x23^3 x23^2 x23 1
    3*x22^2 2*x22 1 0 -3*x22^2 -2*x22 -1 0;
    6*x22 -2 0 0 -6*x22 -2 0 0;
    6*x21 2 0 0 0 0 0 0;
    0 0 0 0 6*x23 2 0 0];
x2 = inv(A2)*y2
%*******Step3 plot result*********
t1 = 1:0.1:2;
y1 = x1(1)*(t1.^3)+x1(2)*(t1.^2)+x1(3)*t1+x1(4);
t2 = 2:0.1:3;
y2 = x1(5)*(t2.^3)+x1(6)*(t2.^2)+x1(7)*t2+x1(8);
t3 = 3:0.1:4;
y3 = x2(1)*(t3.^3)+x2(2)*(t3.^2)+x2(3)*t3+x2(4);
t4 = 4:0.1:5;
y4 = x2(5)*(t4.^3)+x2(6)*(t4.^2)+x2(7)*t4+x2(8);
grid
figure(1)
plot(t1,y1,t2,y2,t3,y3,t4,y4)